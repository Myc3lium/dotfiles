#!/bin/bash

gitStatus(){
	git status &> /dev/null
	if [ $? -eq 0 ]; then
		echo -n ">"
		tput rev
		
		branch=" $(git branch 2>/dev/null)"
		untracked="? $( git ls-files --others --exclude-standard | wc -l)"
		changed="✚ $(git ls-files -m | wc -l)"
		staged="✔ $(git ls-files -s | wc -l)"

		echo -n " $branch, $untracked, $changed, $staged";

		tput sgr0
		echo -n  ""
	fi
}

rootIndicator(){
	if [[ "$USER" = "root" ]];
	then
		echo "! "
	fi
}

utime(){
	echo "[ $(uptime --pretty) ]"
}

userHost(){
	tput rev
	echo -n " $USER @ $HOSTNAME "
	tput sgr0
}

getDir(){
	tput setab 21
	echo -n ">"
	tput setaf 78
	wd="$(pwd)"
	if [[ wd = $HOME ]]; then
		echo -n "~"
	else
		echo -n "~"
		python3 -c "print('$wd'[len('$HOME'):], end = '')"
	fi
}

upTime(){
	tput sc
	utime="$(uptime --pretty)"
	string="$COLUMNS - (len('$utime') + 3)"
	fset=$(python3 -c "print($string)")
	tput cuf $fset
	echo -n "<"$(tput rev)$utime
	tput sgr0
	tput rc
}

PS1='\n$(upTime)$(userHost)> \w $(gitStatus)\n└── $(rootIndicator)ﬦ : '
PS2='└─── $(rootIndicator)? : '
